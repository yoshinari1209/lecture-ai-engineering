import streamlit as st
import pandas as pd
import time

# -------------------------------------------------
# ãƒšãƒ¼ã‚¸è¨­å®š
# -------------------------------------------------
st.set_page_config(
    page_title="Git ä½¿ã„æ–¹è¬›åº§ - åˆå¿ƒè€…å‘ã‘",
    layout="wide",
    initial_sidebar_state="expanded",
)

# -------------------------------------------------
# ã‚¿ã‚¤ãƒˆãƒ« & èª¬æ˜
# -------------------------------------------------
st.title("ğŸ™ Git ä½¿ã„æ–¹è¬›åº§ (åˆå¿ƒè€…å‘ã‘)")
st.markdown(
    """
### ã“ã®ãƒšãƒ¼ã‚¸ã§ã¯ã€Git ã® **è¶…åŸºæœ¬æ“ä½œ** ã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«å­¦ã³ã¾ã™  
- **ã‚³ãƒãƒ³ãƒ‰ã¯ã™ã¹ã¦ã‚³ãƒ”ãƒšå¯èƒ½**  
- æ‰‹å…ƒã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿéš›ã«å‹•ã‹ã—ãªãŒã‚‰ç¢ºèªã—ã¦ã¿ã¾ã—ã‚‡ã†  
- ã‚ã‹ã‚‰ãªããªã£ãŸã‚‰å³ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‹ã‚‰ãƒˆãƒ”ãƒƒã‚¯ã‚’åˆ‡ã‚Šæ›¿ãˆã¦ãã ã•ã„
"""
)

st.divider()

# -------------------------------------------------
# ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼šãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³
# -------------------------------------------------
st.sidebar.header("ğŸ“š å­¦ç¿’ãƒŠãƒ“")
topic = st.sidebar.radio(
    "ãƒˆãƒ”ãƒƒã‚¯ã‚’é¸æŠã—ã¦ãã ã•ã„",
    (
        "â‘  Git ã‚’æº–å‚™ã—ã‚ˆã†",
        "â‘¡ ãƒ­ãƒ¼ã‚«ãƒ«ä½œæ¥­ã®åŸºæœ¬",
        "â‘¢ ãƒ–ãƒ©ãƒ³ãƒã‚’ä½¿ãŠã†",
        "â‘£ ãƒªãƒ¢ãƒ¼ãƒˆã¸ Push",
        "â‘¤ å›°ã£ãŸã¨ãã®å¯¾å‡¦æ³•",
    ),
)

# -------------------------------------------------
# ãƒˆãƒ”ãƒƒã‚¯ â‘ ï¼šGit ã‚’æº–å‚™ã—ã‚ˆã†
# -------------------------------------------------
if topic.startswith("â‘ "):
    st.header("â‘  Git ã‚’æº–å‚™ã—ã‚ˆã†")
    st.markdown(
        """
#### 1. Git ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç¢ºèª
ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã€ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒè¡¨ç¤ºã•ã‚Œã‚Œã° OK ã§ã™ã€‚
"""
    )
    st.code("git --version")

    st.markdown(
        """
#### 2. ãƒ¦ãƒ¼ã‚¶ãƒ¼æƒ…å ±ã‚’è¨­å®š  
ã‚³ãƒŸãƒƒãƒˆã«ã€Œèª°ãŒã€ã€Œã©ã®ãƒ¡ãƒ¼ãƒ«ã§ã€ä½œæ¥­ã—ãŸã‹ã‚’æ®‹ã—ã¾ã™ã€‚
"""
    )
    st.code(
        """
git config --global user.name  "YOUR_NAME"
git config --global user.email "YOUR_EMAIL@example.com"
"""
    )

    st.markdown(
        """
#### 3. è¨­å®šå†…å®¹ã‚’ç¢ºèª
"""
    )
    st.code("git config --list --global")

# -------------------------------------------------
# ãƒˆãƒ”ãƒƒã‚¯ â‘¡ï¼šãƒ­ãƒ¼ã‚«ãƒ«ä½œæ¥­ã®åŸºæœ¬
# -------------------------------------------------
elif topic.startswith("â‘¡"):
    st.header("â‘¡ ãƒ­ãƒ¼ã‚«ãƒ«ä½œæ¥­ã®åŸºæœ¬")
    st.markdown("#### 1. æ–°ã—ã„ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆ")
    st.code(
        """
mkdir my_project
cd my_project
git init      # .git ãƒ•ã‚©ãƒ«ãƒ€ãŒä½œæˆã•ã‚Œã‚‹
"""
    )

    st.markdown("#### 2. å¤‰æ›´ã‚’ç¢ºèª & ã‚¹ãƒ†ãƒ¼ã‚¸ãƒ³ã‚°")
    st.code(
        """
git status              # å¤‰æ›´ç‚¹ã‚’ç¢ºèª
git add <ãƒ•ã‚¡ã‚¤ãƒ«å>     # å¤‰æ›´ã‚’ã‚¹ãƒ†ãƒ¼ã‚¸ã¸
git add .               # ã¾ã¨ã‚ã¦è¿½åŠ 
"""
    )

    st.markdown("#### 3. ã‚³ãƒŸãƒƒãƒˆã‚’ä½œæˆ")
    st.code('git commit -m "æœ€åˆã®ã‚³ãƒŸãƒƒãƒˆ"')

    st.info("ğŸ’¡ **Tip**: `git add` â†’ `git commit` ã® 2 æ®µéšã§å±¥æ­´ã«æ®‹ã™ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚")

# -------------------------------------------------
# ãƒˆãƒ”ãƒƒã‚¯ â‘¢ï¼šãƒ–ãƒ©ãƒ³ãƒã‚’ä½¿ãŠã†
# -------------------------------------------------
elif topic.startswith("â‘¢"):
    st.header("â‘¢ ãƒ–ãƒ©ãƒ³ãƒã‚’ä½¿ãŠã†")
    st.markdown("#### 1. ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆã—ã¦åˆ‡ã‚Šæ›¿ãˆ")
    st.code(
        """
git branch feature-xyz       # ãƒ–ãƒ©ãƒ³ãƒä½œæˆ
git switch feature-xyz       # ã‚ã‚‹ã„ã¯: git checkout feature-xyz
"""
    )

    st.markdown("#### 2. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆã—ã¦ main ã«çµ±åˆ")
    st.code(
        """
# (feature-xyz ä¸Šã§ç·¨é›† â†’ add â†’ commit)
git switch main
git merge feature-xyz
"""
    )
    st.success("ãƒãƒ¼ã‚¸å®Œäº†ï¼ ğŸ‰")

# -------------------------------------------------
# ãƒˆãƒ”ãƒƒã‚¯ â‘£ï¼šãƒªãƒ¢ãƒ¼ãƒˆã¸ Push
# -------------------------------------------------
elif topic.startswith("â‘£"):
    st.header("â‘£ ãƒªãƒ¢ãƒ¼ãƒˆã¸ Push")
    st.markdown("#### 1. GitHub ã§ç©ºã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ä½œæˆã—ã€URL ã‚’ã‚³ãƒ”ãƒ¼")
    st.markdown(
        "> ä¾‹: `https://github.com/YOUR_NAME/my_project.git` ã‚’æƒ³å®šã—ã¾ã™ã€‚"
    )

    st.markdown("#### 2. ãƒªãƒ¢ãƒ¼ãƒˆã‚’ç™»éŒ²ã—ã¦ Push")
    st.code(
        """
git remote add origin https://github.com/YOUR_NAME/my_project.git
git branch -M main           # main ãƒ–ãƒ©ãƒ³ãƒã‚’æ—¢å®šã«
git push -u origin main      # åˆå›ã®ã¿ -u ã‚’ä»˜ã‘ã‚‹ã¨è¿½è·¡è¨­å®šã•ã‚Œã‚‹
"""
    )

    # ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼ã§ Push ã‚’ç–‘ä¼¼ä½“é¨“
    st.subheader("Push ã®ã‚¤ãƒ¡ãƒ¼ã‚¸")
    prog = st.progress(0, text="Push ä¸­...")
    for i in range(101):
        time.sleep(0.01)
        prog.progress(i, text=f"Push ä¸­... {i}%")
    st.balloons()

# -------------------------------------------------
# ãƒˆãƒ”ãƒƒã‚¯ â‘¤ï¼šå›°ã£ãŸã¨ãã®å¯¾å‡¦æ³•
# -------------------------------------------------
elif topic.startswith("â‘¤"):
    st.header("â‘¤ å›°ã£ãŸã¨ãã®å¯¾å‡¦æ³•")
    st.markdown("#### 1. ç›´å‰ã® add ã‚’å–ã‚Šæ¶ˆã™")
    st.code("git restore --staged <ãƒ•ã‚¡ã‚¤ãƒ«å>")

    st.markdown("#### 2. ç›´å‰ã® commit ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’ä¿®æ­£")
    st.code('git commit --amend -m "ä¿®æ­£å¾Œã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸"')

    st.markdown("#### 3. ã†ã£ã‹ã‚Šãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ¶ˆã—ãŸã¨ã")
    st.code("git restore <ãƒ•ã‚¡ã‚¤ãƒ«å>")

    st.warning("âš ï¸ **æ³¨æ„**: `git reset --hard` ã¯å±¥æ­´ã‚’å·»ãæˆ»ã™å¼·åŠ›ãªã‚³ãƒãƒ³ãƒ‰ã€‚ä½¿ã†å‰ã«å¿…ãš `git log` ã§ç¢ºèªï¼")

# -------------------------------------------------
# ã‚ˆãä½¿ã†ã‚³ãƒãƒ³ãƒ‰æ—©è¦‹è¡¨
# -------------------------------------------------
st.divider()
st.subheader("ğŸ“Œ ã‚ˆãä½¿ã† Git ã‚³ãƒãƒ³ãƒ‰æ—©è¦‹è¡¨")

cmd_df = pd.DataFrame(
    {
        "ã‚³ãƒãƒ³ãƒ‰": [
            "git init",
            "git status",
            "git add <file>",
            "git commit -m 'msg'",
            "git branch <name>",
            "git switch <name>",
            "git merge <name>",
            "git clone <url>",
            "git pull",
            "git push",
        ],
        "èª¬æ˜": [
            "ãƒªãƒã‚¸ãƒˆãƒªã‚’åˆæœŸåŒ–",
            "å¤‰æ›´ç‚¹ã‚’ç¢ºèª",
            "ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¹ãƒ†ãƒ¼ã‚¸ã¸",
            "ã‚¹ãƒ†ãƒ¼ã‚¸ â†’ å±¥æ­´ã¸",
            "æ–°ã—ã„ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ",
            "ãƒ–ãƒ©ãƒ³ãƒã‚’åˆ‡ã‚Šæ›¿ãˆ",
            "ãƒ–ãƒ©ãƒ³ãƒã‚’çµ±åˆ",
            "ãƒªãƒã‚¸ãƒˆãƒªã‚’è¤‡è£½",
            "ãƒªãƒ¢ãƒ¼ãƒˆã®å¤‰æ›´ã‚’å–å¾—",
            "ãƒ­ãƒ¼ã‚«ãƒ«å¤‰æ›´ã‚’é€ä¿¡",
        ],
    }
)
st.dataframe(cmd_df, use_container_width=True)

# -------------------------------------------------
# ãƒ•ãƒƒã‚¿ãƒ¼
# -------------------------------------------------
st.markdown(
    """
---
##### ğŸš€ ã“ã‚Œã§æº–å‚™å®Œäº†ï¼  
ãƒ­ãƒ¼ã‚«ãƒ«ã§å®Ÿéš›ã«ã‚³ãƒãƒ³ãƒ‰ã‚’æ‰“ã£ã¦ã¿ã¦ã€Git ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã‚’ä½“æ„Ÿã—ã¾ã—ã‚‡ã†ã€‚
"""
)
